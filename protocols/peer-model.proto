syntax = "proto3";

package ipc;

option go_package = "internal/model";


service Train {
	rpc Train(TrainRequest) returns (TrainResponse);
}

service Eval {
	rpc Eval(EvalRequest) returns (EvalResponse);
}

service ExportWeights {
	rpc ExportWeights(ExportRequest) returns (ExportResponse);
}

service ImportWeights {
	rpc ImportWeights(ImportRequest) returns (ImportResponse);
}


message TrainRequest {}
message TrainResponse {
	bool success = 1;
	string error_message = 2;
	float loss = 3;
}

message EvalRequest {
	string path = 1;
}

message EvalResponse {
	bool success = 1;
	string error_message = 2;
	float loss = 3;
	float accuracy = 4;
	map<int32, float> guesses = 5;
}

message ExportRequest {}
message ExportResponse {
	bool success = 1;
	string error_message = 2;
	bytes weights = 3;
}

message ImportRequest {
	bytes weights = 1;  // Serialized PyTorch state dict
	float weight_ratio = 2;
}
message ImportResponse {
	bool success = 1;
	string error_message = 2;
}
